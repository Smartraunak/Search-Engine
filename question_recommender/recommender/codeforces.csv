index,Question Name,Question Difficulty,Question Description,Question Url
0,"
Monocarp and a Strategic Game                    ",1500,"Monocarp plays a strategic computer game in which he develops a city. The city is inhabited by creatures of four different races — humans, elves, orcs, and dwarves. Each inhabitant of the city has a happiness value, which is an integer. It depends on how many creatures of different races inhabit the city. Specifically, the happiness of each inhabitant is 0 by default; it increases by 1 for each other creature of the same race and decreases by 1 for each creature of a hostile race. Humans are hostile to orcs (and vice versa), and elves are hostile to dwarves (and vice versa). At the beginning of the game, Monocarp's city is not inhabited by anyone. During the game, n groups of creatures will come to his city, wishing to settle there. The i-th group consists of ai humans, bi orcs, ci elves, and di dwarves. Each time, Monocarp can either accept the entire group of creatures into the city, or reject the entire group. The game calculates Monocarp's score according to the following formula: m+k, where m is the number of inhabitants in the city, and k is the sum of the happiness values of all creatures in the city. Help Monocarp earn the maximum possible number of points by the end of the game!",https://codeforces.com/problemset/problem/1841/F
1,"
Fill the Matrix                    ",1500,"There is a square matrix, consisting of n rows and n columns of cells, both numbered from 1 to n. The cells are colored white or black. Cells from 1 to ai are black, and cells from ai+1 to n are white, in the i-th column. You want to place m integers in the matrix, from 1 to m. There are two rules:  The beauty of the matrix is the number of such j that j+1 is written in the same row, in the next column as j (in the neighbouring cell to the right). What's the maximum possible beauty of the matrix?",https://codeforces.com/problemset/problem/1841/E
2,"
Pairs of Segments                    ",1500,"Two segments [l1,r1] and [l2,r2] intersect if there exists at least one x such that l1≤x≤r1 and l2≤x≤r2. An array of segments [[l1,r1],[l2,r2],…,[lk,rk]] is called beautiful if k is even, and is possible to split the elements of this array into k2 pairs in such a way that: For example, the array [[2,4],[9,12],[2,4],[7,7],[10,13],[6,8]] is beautiful, since it is possible to form 3 pairs as follows: As you can see, the segments in each pair intersect, and no segments from different pairs intersect. You are given an array of n segments [[l1,r1],[l2,r2],…,[ln,rn]]. You have to remove the minimum possible number of elements from this array so that the resulting array is beautiful.",https://codeforces.com/problemset/problem/1841/D
3,"
Ranom Numbers                    ",1500,"No, not ""random"" numbers. Ranom digits are denoted by uppercase Latin letters from A to E. Moreover, the value of the letter A is 1, B is 10, C is 100, D is 1000, E is 10000. A Ranom number is a sequence of Ranom digits. The value of the Ranom number is calculated as follows: the values of all digits are summed up, but some digits are taken with negative signs: a digit is taken with negative sign if there is a digit with a strictly greater value to the right of it (not necessarily immediately after it); otherwise, that digit is taken with a positive sign. For example, the value of the Ranom number DAAABDCA is 1000−1−1−1−10+1000+100+1=2088. You are given a Ranom number. You can change no more than one digit in it. Calculate the maximum possible value of the resulting number.",https://codeforces.com/problemset/problem/1841/C
4,"
Keep it Beautiful                    ",1500,"The array [a1,a2,…,ak] is called beautiful if it is possible to remove several (maybe zero) elements from the beginning of the array and insert all these elements to the back of the array in the same order in such a way that the resulting array is sorted in non-descending order. In other words, the array [a1,a2,…,ak] is beautiful if there exists an integer i∈[0,k−1] such that the array [ai+1,ai+2,…,ak−1,ak,a1,a2,…,ai] is sorted in non-descending order. For example: Note that any array consisting of zero elements or one element is beautiful. You are given an array a, which is initially empty. You have to process q queries to it. During the i-th query, you will be given one integer xi, and you have to do the following: After each query, report whether you appended the given integer xi, or not.",https://codeforces.com/problemset/problem/1841/B
5,"
Game with Board                    ",1500,"Alice and Bob play a game. They have a blackboard; initially, there are n integers written on it, and each integer is equal to 1. Alice and Bob take turns; Alice goes first. On their turn, the player has to choose several (at least two) equal integers on the board, wipe them and write a new integer which is equal to their sum. For example, if the board currently contains integers {1,1,2,2,2,3}, then the following moves are possible: If a player cannot make a move (all integers on the board are different), that player wins the game. Determine who wins if both players play optimally.",https://codeforces.com/problemset/problem/1841/A
6,"
In Search of Truth (Hard Version)                    ",2500,"The only difference between easy and hard versions is the maximum number of queries. In this version, you are allowed to ask at most 1000 queries. This is an interactive problem. You are playing a game. The circle is divided into n sectors, sectors are numbered from 1 to n in some order. You are in the adjacent room and do not know either the number of sectors or their numbers. There is also an arrow that initially points to some sector. Initially, the host tells you the number of the sector to which the arrow points. After that, you can ask the host to move the arrow k sectors counterclockwise or clockwise at most 1000 times. And each time you are told the number of the sector to which the arrow points. Your task is to determine the integer n — the number of sectors in at most 1000 queries. It is guaranteed that 1≤n≤106.",https://codeforces.com/problemset/problem/1840/G2
7,"
In Search of Truth (Easy Version)                    ",2200,"The only difference between easy and hard versions is the maximum number of queries. In this version, you are allowed to ask at most 2023 queries. This is an interactive problem. You are playing a game. The circle is divided into n sectors, sectors are numbered from 1 to n in some order. You are in the adjacent room and do not know either the number of sectors or their numbers. There is also an arrow that initially points to some sector. Initially, the host tells you the number of the sector to which the arrow points. After that, you can ask the host to move the arrow k sectors counterclockwise or clockwise at most 2023 times. And each time you are told the number of the sector to which the arrow points. Your task is to determine the integer n — the number of sectors in at most 2023 queries. It is guaranteed that 1≤n≤106.",https://codeforces.com/problemset/problem/1840/G1
8,"
Railguns                    ",2200,"Tema is playing a very interesting computer game. During the next mission, Tema's character found himself on an unfamiliar planet. Unlike Earth, this planet is flat and can be represented as an n×m rectangle. Tema's character is located at the point with coordinates (0,0). In order to successfully complete the mission, he needs to reach the point with coordinates (n,m) alive. Let the character of the computer game be located at the coordinate (i,j). Every second, starting from the first, Tema can: The aliens that inhabit this planet are very dangerous and hostile. Therefore, they will shoot from their railguns r times. Each shot completely penetrates one coordinate vertically or horizontally. If the character is in the line of its impact at the time of the shot (at the end of the second), he dies. Since Tema looked at the game's source code, he knows complete information about each shot — the time, the penetrated coordinate, and the direction of the shot. What is the minimum time for the character to reach the desired point? If he is doomed to die and cannot reach the point with coordinates (n,m), output −1.",https://codeforces.com/problemset/problem/1840/F
9,"
Character Blocking                    ",1600,"You are given two strings of equal length s1 and s2, consisting of lowercase Latin letters, and an integer t. You need to answer q queries, numbered from 1 to q. The i-th query comes in the i-th second of time. Each query is one of three types:  Note that in queries of the second type, the characters being swapped can be from the same string or from s1 and s2.",https://codeforces.com/problemset/problem/1840/E
10,"
Wooden Toy Festival                    ",1400,"In a small town, there is a workshop specializing in woodwork. Since the town is small, only three carvers work there. Soon, a wooden toy festival is planned in the town. The workshop employees want to prepare for it. They know that n people will come to the workshop with a request to make a wooden toy. People are different and may want different toys. For simplicity, let's denote the pattern of the toy that the i-th person wants as ai (1≤ai≤109). Each of the carvers can choose an integer pattern x (1≤x≤109) in advance, different carvers can choose different patterns. x is the integer. During the preparation for the festival, the carvers will perfectly work out the technique of making the toy of the chosen pattern, which will allow them to cut it out of wood instantly. To make a toy of pattern y for a carver who has chosen pattern x, it will take |x−y| time, because the more the toy resembles the one he can make instantly, the faster the carver will cope with the work. On the day of the festival, when the next person comes to the workshop with a request to make a wooden toy, the carvers can choose who will take on the job. At the same time, the carvers are very skilled people and can work on orders for different people simultaneously. Since people don't like to wait, the carvers want to choose patterns for preparation in such a way that the maximum waiting time over all people is as small as possible. Output the best maximum waiting time that the carvers can achieve.",https://codeforces.com/problemset/problem/1840/D
11,"
Ski Resort                    ",1000,"Dima Vatrushin is a math teacher at school. He was sent on vacation for n days for his good work. Dima has long dreamed of going to a ski resort, so he wants to allocate several consecutive days and go skiing. Since the vacation requires careful preparation, he will only go for at least k days. You are given an array a containing the weather forecast at the resort. That is, on the i-th day, the temperature will be ai degrees. Dima was born in Siberia, so he can go on vacation only if the temperature does not rise above q degrees throughout the vacation. Unfortunately, Dima was so absorbed in abstract algebra that he forgot how to count. He asks you to help him and count the number of ways to choose vacation dates at the resort.",https://codeforces.com/problemset/problem/1840/C
12,"
Binary Cafe                    ",1100,"Once upon a time, Toma found himself in a binary cafe. It is a very popular and unusual place. The cafe offers visitors k different delicious desserts. The desserts are numbered from 0 to k−1. The cost of the i-th dessert is 2i coins, because it is a binary cafe! Toma is willing to spend no more than n coins on tasting desserts. At the same time, he is not interested in buying any dessert more than once, because one is enough to evaluate the taste. In how many different ways can he buy several desserts (possibly zero) for tasting?",https://codeforces.com/problemset/problem/1840/B
13,"
Cipher Shifer                    ",800,"There is a string a (unknown to you), consisting of lowercase Latin letters, encrypted according to the following rule into string s: You are given string s, and you need to output the initial string a. In other words, you need to decrypt string s. Note that each string encrypted in this way is decrypted uniquely.",https://codeforces.com/problemset/problem/1840/A
14,"
Decreasing Game                    ",2400,This is an interactive problem. Consider the following game for two players: It can be shown that game always ends after the finite number of rounds. You have to select which player you will play for (first or second) and win the game.,https://codeforces.com/problemset/problem/1839/E
15,"
Ball Sorting                    ",2100,"There are n colorful balls arranged in a row. The balls are painted in n distinct colors, denoted by numbers from 1 to n. The i-th ball from the left is painted in color ci. You want to reorder the balls so that the i-th ball from the left has color i. Additionally, you have k≥1 balls of color 0 that you can use in the reordering process. Due to the strange properties of the balls, they can be reordered only by performing the following operations: You can perform these operations in any order. After the last operation, all balls of color 0 magically disappear, leaving a sequence of n balls of non-zero colors. What is the minimum amount of coins you should spend on the operations of the second type, so that the i-th ball from the left has color i for all i from 1 to n after the disappearance of all balls of color zero? It can be shown that under the constraints of the problem, it is always possible to reorder the balls in the required way.  Solve the problem for all k from 1 to n.",https://codeforces.com/problemset/problem/1839/D
16,"
Insert Zero and Invert Prefix                    ",1300,"You have a sequence a1,a2,…,an of length n, each element of which is either 0 or 1, and a sequence b, which is initially empty. You are going to perform n operations. On each of them you will increase the length of b by 1. You can find examples of operations in the Notes section. Determine if there exists a sequence of operations that makes b equal to a. If such sequence of operations exists, find it.",https://codeforces.com/problemset/problem/1839/C
17,"
Lamps                    ",1100,"You have n lamps, numbered by integers from 1 to n. Each lamp i has two integer parameters ai and bi. At each moment each lamp is in one of three states: it may be turned on, turned off, or broken. Initially all lamps are turned off. In one operation you can select one lamp that is turned off and turn it on (you can't turn on broken lamps). You receive bi points for turning lamp i on. The following happens after each performed operation:  Please note that broken lamps never count as turned on and that after a turned on lamp breaks, you still keep points received for turning it on. You can perform an arbitrary number of operations. Find the maximum number of points you can get.",https://codeforces.com/problemset/problem/1839/B
18,"
The Good Array                    ",800,"You are given two integers n and k. An array a1,a2,…,an of length n, consisting of zeroes and ones is good if for all integers i from 1 to n both of the following conditions are satisfied: Here, ⌈ik⌉ denotes the result of division of i by k, rounded up. For example, ⌈63⌉=2, ⌈115⌉=⌈2.2⌉=3 and ⌈74⌉=⌈1.75⌉=2. Find the minimum possible number of ones in a good array.",https://codeforces.com/problemset/problem/1839/A
19,"
Stuck Conveyor                    ",3000,"This is an interactive problem. There is an n by n grid of conveyor belts, in positions (1,1) through (n,n) of a coordinate plane. Every other square in the plane is empty. Each conveyor belt can be configured to move boxes up ('^'), down ('v'), left ('<'), or right ('>'). If a box moves onto an empty square, it stops moving. However, one of the n2 belts is stuck, and will always move boxes in the same direction, no matter how it is configured. Your goal is to perform a series of tests to determine which conveyor belt is stuck, and the direction in which it sends items. To achieve this, you can perform up to 25 tests. In each test, you assign a direction to all n2 belts, place a box on top of one of them, and then turn all of the conveyors on.  The conveyors move the box around too quickly for you to see, so the only information you receive from a test is whether the box eventually stopped moving, and if so, the coordinates of its final position.",https://codeforces.com/problemset/problem/1838/F
20,"
Count Supersequences                    ",2500,"You are given an array a of n integers, where all elements ai lie in the range [1,k]. How many different arrays b of m integers, where all elements bi lie in the range [1,k], contain a as a subsequence? Two arrays are considered different if they differ in at least one position. A sequence x is a subsequence of a sequence y if x can be obtained from y by the deletion of several (possibly, zero or all) elements. Since the answer may be large, print it modulo 109+7.",https://codeforces.com/problemset/problem/1838/E
21,"
Bracket Walk                    ",2100,"There is a string s of length n consisting of the characters '(' and ')'. You are walking on this string. You start by standing on top of the first character of s, and you want to make a sequence of moves such that you end on the n-th character. In one step, you can move one space to the left (if you are not standing on the first character), or one space to the right (if you are not standing on the last character). You may not stay in the same place, however you may visit any character, including the first and last character, any number of times. At each point in time, you write down the character you are currently standing on. We say the string is walkable if there exists some sequence of moves that take you from the first character to the last character, such that the string you write down is a regular bracket sequence. A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters '1' and '+' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not. You are given q queries. Each query flips the value of a character from '(' to ')' or vice versa. After each query, determine whether the string is walkable. Queries are cumulative, so the effects of each query carry on to future queries.",https://codeforces.com/problemset/problem/1838/D
22,"
No Prime Differences                    ",1400,"You are given integers n and m. Fill an n by m grid with the integers 1 through n⋅m, in such a way that for any two adjacent cells in the grid, the absolute difference of the values in those cells is not a prime number. Two cells in the grid are considered adjacent if they share a side. It can be shown that under the given constraints, there is always a solution.",https://codeforces.com/problemset/problem/1838/C
23,"
Minimize Permutation Subarrays                    ",1100,"You are given a permutation p of size n. You want to minimize the number of subarrays of p that are permutations. In order to do so, you must perform the following operation exactly once: For example, if p=[5,1,4,2,3] and we choose i=2, j=3, the resulting array will be [5,4,1,2,3]. If instead we choose i=j=5, the resulting array will be [5,1,4,2,3]. Which choice of i and j will minimize the number of subarrays that are permutations? A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). An array a is a subarray of an array b if a can be obtained from b by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.",https://codeforces.com/problemset/problem/1838/B
24,"
Blackboard List                    ",800,"Two integers were written on a blackboard. After that, the following step was carried out n−2 times: After this process was complete, the list of n integers was shuffled. You are given the final list. Recover one of the initial two numbers. You do not need to recover the other one. You are guaranteed that the input can be generated using the above process.",https://codeforces.com/problemset/problem/1838/A
25,"
Editorial for Two                    ",2400,"Berland Intercollegiate Contest has just finished. Monocarp and Polycarp, as the jury, are going to conduct an editorial. Unfortunately, the time is limited, since they have to finish before the closing ceremony. There were n problems in the contest. The problems are numbered from 1 to n. The editorial for the i-th problem takes ai minutes. Monocarp and Polycarp are going to conduct an editorial for exactly k of the problems. The editorial goes as follows. They have a full problemset of n problems before them, in order. They remove n−k problems without changing the order of the remaining k problems. Then, Monocarp takes some prefix of these k problems (possibly, an empty one or all problems). Polycarp takes the remaining suffix of them. After that, they go to different rooms and conduct editorials for their problems in parallel. So, the editorial takes as much time as the longer of these two does. Please, help Monocarp and Polycarp to choose the problems and the split in such a way that the editorial finishes as early as possible. Print the duration of the editorial.",https://codeforces.com/problemset/problem/1837/F
26,"
Playoff Fixing                    ",2200,"2k teams participate in a playoff tournament. The teams are numbered from 1 to 2k, in order of decreasing strength. So, team 1 is the strongest one, team 2k is the weakest one. A team with a smaller number always defeats a team with a larger number. First of all, the teams are arranged in some order during a procedure called seeding. Each team is assigned another unique value from 1 to 2k, called a seed, that represents its starting position in the playoff. The tournament consists of 2k−1 games. They are held as follows: the teams are split into pairs: team with seed 1 plays against team with seed 2, team with seed 3 plays against team with seed 4 (exactly in this order), and so on (so, 2k−1 games are played in that phase). When a team loses a game, it is eliminated. After that, only 2k−1 teams remain. If only one team remains, it is declared the champion; otherwise, 2k−2 games are played: in the first one of them, the winner of the game ""seed 1 vs seed 2"" plays against the winner of the game ""seed 3 vs seed 4"", then the winner of the game ""seed 5 vs seed 6"" plays against the winner of the game ""seed 7 vs seed 8"", and so on. This process repeats until only one team remains. After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular: Now that we established the rules, we do a little rigging. In particular, we want:  For example, this picture describes one of the possible ways the tournament can go with k=3, and the resulting places of the teams: Some seeds are already reserved for some teams (we are not the only ones rigging the tournament, apparently). We have to fill the rest of the seeds with the remaining teams to achieve the desired placements. How many ways are there to do that? Since that value might be large, print it modulo 998244353.",https://codeforces.com/problemset/problem/1837/E
27,"
Bracket Coloring                    ",1400,"A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example: A bracket sequence is called beautiful if one of the following conditions is satisfied: For example, the bracket sequences ""()()"", ""(())"", "")))((("", ""))()(("" are beautiful. You are given a bracket sequence s. You have to color it in such a way that: Color the given bracket sequence s into the minimum number of colors according to these constraints, or report that it is impossible.",https://codeforces.com/problemset/problem/1837/D
28,"
Best Binary String                    ",1000,"You are given a string s consisting of the characters 0, 1 and/or ?. Let's call it a pattern. Let's say that the binary string (a string where each character is either 0 or 1) matches the pattern if you can replace each character ? with 0 or 1 (for each character, the choice is independent) so that the strings become equal. For example, 0010 matches ?01?, but 010 doesn't match 1??, ??, or ????. Let's define the cost of the binary string as the minimum number of operations of the form ""reverse an arbitrary contiguous substring of the string"" required to sort the string in non-descending order. You have to find a binary string with the minimum possible cost among those that match the given pattern. If there are multiple answers, print any of them.",https://codeforces.com/problemset/problem/1837/C
29,"
Comparison String                    ",900,"You are given a string s of length n, where each character is either < or >. An array a consisting of n+1 elements is compatible with the string s if, for every i from 1 to n, the character si represents the result of comparing ai and ai+1, i. e.: For example, the array [1,2,5,4,2] is compatible with the string <<>>. There are other arrays with are compatible with that string, for example, [13,37,42,37,13]. The cost of the array is the number of different elements in it. For example, the cost of [1,2,5,4,2] is 4; the cost of [13,37,42,37,13] is 3. You have to calculate the minimum cost among all arrays which are compatible with the given string s.",https://codeforces.com/problemset/problem/1837/B
30,"
Grasshopper on a Line                    ",800,"You are given two integers x and k. Grasshopper starts in a point 0 on an OX axis. In one move, it can jump some integer distance, that is not divisible by k, to the left or to the right. What's the smallest number of moves it takes the grasshopper to reach point x? What are these moves? If there are multiple answers, print any of them.",https://codeforces.com/problemset/problem/1837/A
31,"
Ksyusha and Chinchilla                    ",1800,"Ksyusha has a pet chinchilla, a tree on n vertices and huge scissors. A tree is a connected graph without cycles. During a boring physics lesson Ksyusha thought about how to entertain her pet. Chinchillas like to play with branches. A branch is a tree of 3 vertices. A cut is the removal of some (not yet cut) edge in the tree. Ksyusha has plenty of free time, so she can afford to make enough cuts so that the tree splits into branches. In other words, after several (possibly zero) cuts, each vertex must belong to exactly one branch. Help Ksyusha choose the edges to be cut or tell that it is impossible.",https://codeforces.com/problemset/problem/1833/G
32,"
Ira and Flamenco                    ",1700,"Ira loves Spanish flamenco dance very much. She decided to start her own dance studio and found n students, ith of whom has level ai. Ira can choose several of her students and set a dance with them. So she can set a huge number of dances, but she is only interested in magnificent dances. The dance is called magnificent if the following is true:  For example, if m=3 and a=[4,2,2,3,6], the following dances are magnificent (students participating in the dance are highlighted in red): [4,2,2,3,6], [4,2,2,3,6]. At the same time dances [4,2,2,3,6], [4,2,2,3,6], [4,2,2,3,6] are not magnificent. In the dance [4,2,2,3,6] only 2 students participate, although m=3. The dance [4,2,2,3,6] involves students with levels 2 and 2, although levels of all dancers must be pairwise distinct. In the dance [4,2,2,3,6] students with levels 3 and 6 participate, but |3−6|=3, although m=3. Help Ira count the number of magnificent dances that she can set. Since this number can be very large, count it modulo 109+7. Two dances are considered different if the sets of students participating in them are different.",https://codeforces.com/problemset/problem/1833/F
33,"
Round Dance                    ",1600,"n people came to the festival and decided to dance a few round dances. There are at least 2 people in the round dance and each person has exactly two neighbors. If there are 2 people in the round dance then they have the same neighbor on each side. You decided to find out exactly how many dances there were. But each participant of the holiday remembered exactly one neighbor. Your task is to determine what the minimum and maximum number of round dances could be. For example, if there were 6 people at the holiday, and the numbers of the neighbors they remembered are equal [2,1,4,3,6,5], then the minimum number of round dances is1:",https://codeforces.com/problemset/problem/1833/E
34,"
Flipper                    ",1400,"You are given a permutation p of length n. A permutation is an array consisting of n distinct integers from 1 to n in any order. For example, {2,3,1,5,4} is a permutation, while {1,2,2} is not (since 2 appears twice), and {1,3,4} is also not a permutation (as n=3, but the array contains 4). To the permutation p, you need to apply the following operation exactly once: For example, given n=5,p={2,3,1,5,4}, if you choose the segment [l=2,r=3], after reversing the segment p={2,1,3,5,4}, then you swap the segments [4,5] and [1,1]. Thus, p={5,4,1,3,2}. It can be shown that this is the maximum possible result for the given permutation. You need to output the lexicographically maximum permutation that can be obtained by applying the operation described exactly once. A permutation a is lexicographically greater than permutation b if there exists an i (1≤i≤n) such that aj=bj for 1≤j<i and ai>bi.",https://codeforces.com/problemset/problem/1833/D
35,"
Vlad Building Beautiful Array                    ",800,"Vlad was given an array a of n positive integers. Now he wants to build a beautiful array b of length n from it. Vlad considers an array beautiful if all the numbers in it are positive and have the same parity. That is, all numbers in the beautiful array are greater than zero and are either all even or all odd. To build the array b, Vlad can assign each bi either the value ai or ai−aj, where any j from 1 to n can be chosen. To avoid trying to do the impossible, Vlad asks you to determine whether it is possible to build a beautiful array b of length n using his array a.",https://codeforces.com/problemset/problem/1833/C
36,"
Restore the Weather                    ",900,"You are given an array a containing the weather forecast for Berlandia for the last n days. That is, ai — is the estimated air temperature on day i (1≤i≤n). You are also given an array b — the air temperature that was actually present on each of the days. However, all the values in array b are mixed up.  Determine which day was which temperature, if you know that the weather never differs from the forecast by more than k degrees. In other words, if on day i the real air temperature was c, then the equality |ai−c|≤k is always true. For example, let an array a = [1,3,5,3,9] of length n=5 and k=2 be given and an array b = [2,5,11,2,4]. Then, so that the value of bi corresponds to the air temperature on day i, we can rearrange the elements of the array b so: [2,2,5,4,11]. Indeed:",https://codeforces.com/problemset/problem/1833/B
37,"
Musical Puzzle                    ",800,"Vlad decided to compose a melody on his guitar. Let's represent the melody as a sequence of notes corresponding to the characters 'a', 'b', 'c', 'd', 'e', 'f', and 'g'. However, Vlad is not very experienced in playing the guitar and can only record exactly two notes at a time. Vlad wants to obtain the melody s, and to do this, he can merge the recorded melodies together. In this case, the last sound of the first melody must match the first sound of the second melody. For example, if Vlad recorded the melodies ""ab"" and ""ba"", he can merge them together and obtain the melody ""aba"", and then merge the result with ""ab"" to get ""abab"". Help Vlad determine the minimum number of melodies consisting of two notes that he needs to record in order to obtain the melody s.",https://codeforces.com/problemset/problem/1833/A
38,"
Zombies                    ",3200,"Polycarp plays a computer game in a post-apocalyptic setting. The zombies have taken over the world, and Polycarp with a small team of survivors is defending against hordes trying to invade their base. The zombies are invading for x minutes starting from minute 0. There are n entrances to the base, and every minute one zombie attempts to enter through every entrance. The survivors can defend the entrances against the zombies. There are two options:  If an entrance is defended either or both ways during some minute, no zombie goes through. Every entrance is defended by a single dedicated survivor. The i-th entrance is defended manually from minute li until minute ri, non-inclusive — [li,ri). There are k generators that can be used to defend the entrances automatically. Every entrance should be connected to exactly one generator, but a generator can be connected to multiple entrances (or even none of them). Each generator will work for exactly m consecutive minutes. Polycarp can choose when to power on each generator independently of each other, the m minute long interval should be fully inside the [0,x) time interval. Polycarp is a weird gamer. He wants the game to be as difficult as possible for him. So he wants to connect each entrance to a generator and choose the time for each generator in such a way that as many zombies as possible enter the base. Please, help him to achieve that!",https://codeforces.com/problemset/problem/1832/F
39,"
Combinatorics Problem                    ",2200,"Recall that the binomial coefficient (xy) is calculated as follows (x and y are non-negative integers): You are given an array a1,a2,…,an and an integer k. You have to calculate a new array b1,b2,…,bn, where Formally, bi=(i∑j=1(i−j+1k)⋅aj)mod998244353. Note that the array is given in a modified way, and you have to output it in a modified way as well.",https://codeforces.com/problemset/problem/1832/E
40,"
Red-Blue Operations (Hard Version)                    ",2400,"The only difference between easy and hard versions is the maximum values of n and q. You are given an array, consisting of n integers. Initially, all elements are red. You can apply the following operation to the array multiple times. During the i-th operation, you select an element of the array; then:  The operations are numbered from 1, i. e. during the first operation some element is changed by 1 and so on. You are asked q queries of the following form:  Note that the operations don't affect the array between queries, all queries are asked on the initial array a.",https://codeforces.com/problemset/problem/1832/D2
41,"
Red-Blue Operations (Easy Version)                    ",2100,"The only difference between easy and hard versions is the maximum values of n and q. You are given an array, consisting of n integers. Initially, all elements are red. You can apply the following operation to the array multiple times. During the i-th operation, you select an element of the array; then:  The operations are numbered from 1, i. e. during the first operation some element is changed by 1 and so on. You are asked q queries of the following form:  Note that the operations don't affect the array between queries, all queries are asked on the initial array a.",https://codeforces.com/problemset/problem/1832/D1
42,"
Contrast Value                    ",1200,"For an array of integers [a1,a2,…,an], let's call the value |a1−a2|+|a2−a3|+⋯+|an−1−an| the contrast of the array. Note that the contrast of an array of size 1 is equal to 0. You are given an array of integers a. Your task is to build an array of b in such a way that all the following conditions are met: What is the minimum possible size of the array b?",https://codeforces.com/problemset/problem/1832/C
43,"
Maximum Sum                    ",1100,"You are given an array a1,a2,…,an, where all elements are different. You have to perform exactly k operations with it. During each operation, you do exactly one of the following two actions (you choose which to do yourself): You have to calculate the maximum possible sum of elements in the resulting array.",https://codeforces.com/problemset/problem/1832/B
44,"
New Palindrome                    ",800,"A palindrome is a string that reads the same from left to right as from right to left. For example, abacaba, aaaa, abba, racecar are palindromes. You are given a string s consisting of lowercase Latin letters. The string s is a palindrome. You have to check whether it is possible to rearrange the letters in it to get another palindrome (not equal to the given string s).",https://codeforces.com/problemset/problem/1832/A
45,"
Array merging                    ",1000,"You are given two arrays a and b both of length n. You will merge† these arrays forming another array c of length 2⋅n. You have to find the maximum length of a subarray consisting of equal values across all arrays c that could be obtained. † A merge of two arrays results in an array c composed by successively taking the first element of either array (as long as that array is nonempty) and removing it. After this step, the element is appended to the back of c. We repeat this operation as long as we can (i.e. at least one array is nonempty).",https://codeforces.com/problemset/problem/1831/B
46,"
Twin Permutations                    ",800,"You are given a permutation† a of length n. Find any permutation b of length n such that a1+b1≤a2+b2≤a3+b3≤…≤an+bn. It can be proven that a permutation b that satisfies the condition above always exists. † A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).",https://codeforces.com/problemset/problem/1831/A
47,"
The Third Grace                    ",3200,"You are given n intervals and m points on the number line. The i-th intervals covers coordinates [li,ri] and the i-th point is on coordinate i and has coefficient pi. Initially, all points are not activated. You should choose a subset of the m points to activate. For each of n interval, we define its cost as:  Your task is to maximize the sum of the costs of all intervals by choosing which points to activate.",https://codeforces.com/problemset/problem/1830/F
48,"
Bully Sort                    ",3500,"On a permutation p of length n, we define a bully swap as follows: We define f(p) as the number of bully swaps we need to perform until p becomes sorted. Note that if p is the identity permutation, f(p)=0. You are given n and a permutation p of length n. You need to process the following q updates. In each update, you are given two integers x and y. You will swap px and py and then find the value of f(p). Note that the updates are persistent. Changes made to the permutation p will apply when processing future updates.",https://codeforces.com/problemset/problem/1830/E
49,"
Mex Tree                    ",2800,"You are given a tree with n nodes. For each node, you either color it in 0 or 1. The value of a path (u,v) is equal to the MEX† of the colors of the nodes from the shortest path between u and v. The value of a coloring is equal to the sum of values of all paths (u,v) such that 1≤u≤v≤n. What is the maximum possible value of any coloring of the tree? † The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:",https://codeforces.com/problemset/problem/1830/D
50,"
Hyperregular Bracket Strings                    ",2400,"You are given an integer n and k intervals. The i-th interval is [li,ri] where 1≤li≤ri≤n. Let us call a regular bracket sequence†,‡ of length n hyperregular if for each i such that 1≤i≤k, the substring ¯slisli+1…sri is also a regular bracket sequence. Your task is to count the number of hyperregular bracket sequences. Since this number can be really large, you are only required to find it modulo 998244353. † A bracket sequence is a string containing only the characters ""("" and "")"". ‡ A bracket sequence is called regular if one can turn it into a valid math expression by adding characters + and 1. For example, sequences (())(), (), (()(())) and the empty string are regular, while )(, ((), and (()))( are not.",https://codeforces.com/problemset/problem/1830/C
51,"
The BOSS Can Count Pairs                    ",2000,"You are given two arrays a and b, both of length n. Your task is to count the number of pairs of integers (i,j) such that 1≤i<j≤n and ai⋅aj=bi+bj.",https://codeforces.com/problemset/problem/1830/B
52,"
Copil Copac Draws Trees                    ",1400,Copil Copac is given a list of n−1 edges describing a tree of n vertices. He decides to draw it using the following algorithm: The number of readings is defined as the number of times Copil Copac performs step 1. Find the number of readings needed by Copil Copac to draw the tree.,https://codeforces.com/problemset/problem/1830/A
53,"
Don't Blame Me                    ",1700,"Sadly, the problem setter couldn't think of an interesting story, thus he just asks you to solve the following problem. Given an array a consisting of n positive integers, count the number of non-empty subsequences for which the bitwise AND of the elements in the subsequence has exactly k set bits in its binary representation. The answer may be large, so output it modulo 109+7. Recall that the subsequence of an array a is a sequence that can be obtained from a by removing some (possibly, zero) elements. For example, [1,2,3], [3], [1,3] are subsequences of [1,2,3], but [3,2] and [4,5,6] are not. Note that AND represents the bitwise AND operation.",https://codeforces.com/problemset/problem/1829/H
54,"
Hits Different                    ",1600,"In a carnival game, there is a huge pyramid of cans with 2023 rows, numbered in a regular pattern as shown. If can 92 is hit initially, then all cans colored red in the picture above would fall.  You throw a ball at the pyramid, and it hits a single can with number n2. This causes all cans that are stacked on top of this can to fall (that is, can n2 falls, then the cans directly above n2 fall, then the cans directly above those cans, and so on). For example, the picture above shows the cans that would fall if can 92 is hit. What is the sum of the numbers on all cans that fall? Recall that n2=n×n.",https://codeforces.com/problemset/problem/1829/G
55,"
Forever Winter                    ",1300,"A snowflake graph is generated from two integers x and y, both greater than 1, as follows:  The snowflake graph above has a central vertex 15, then x=5 vertices attached to it (3, 6, 7, 8, and 20), and then y=3 vertices attached to each of those.",https://codeforces.com/problemset/problem/1829/F
56,"
The Lakes                    ",1100,"You are given an n×m grid a of non-negative integers. The value ai,j represents the depth of water at the i-th row and j-th column.  A lake is a set of cells such that: The volume of a lake is the sum of depths of all the cells in the lake. Find the largest volume of a lake in the grid.",https://codeforces.com/problemset/problem/1829/E
57,"
Gold Rush                    ",1000,"Initially you have a single pile with n gold nuggets. In an operation you can do the following:  One possible move is to take a pile of size 6 and split it into piles of sizes 2 and 4, which is valid since 4 is twice as large as 2.",https://codeforces.com/problemset/problem/1829/D
58,"
Mr. Perfectly Fine                    ",800,"Victor wants to become ""Mr. Perfectly Fine"". For that, he needs to acquire a certain set of skills. More precisely, he has 2 skills he needs to acquire.  Victor has n books. Reading book i takes him mi minutes and will give him some (possibly none) of the required two skills, represented by a binary string of length 2. What is the minimum amount of time required so that Victor acquires all of the two skills?",https://codeforces.com/problemset/problem/1829/C
59,"
Blank Space                    ",800,"You are given a binary array a of n elements, a binary array is an array consisting only of 0s and 1s.  A blank space is a segment of consecutive elements consisting of only 0s.  Your task is to find the length of the longest blank space.",https://codeforces.com/problemset/problem/1829/B
60,"
Love Story                    ",800,"Timur loves codeforces. That's why he has a string s having length 10 made containing only lowercase Latin letters. Timur wants to know how many indices string s differs from the string ""codeforces"". For example string s= ""coolforsez"" differs from ""codeforces"" in 4 indices, shown in bold. Help Timur by finding the number of indices where string s differs from ""codeforces"". Note that you can't reorder the characters in the string s.",https://codeforces.com/problemset/problem/1829/A
61,"
Permutation Swap                    ",900,"You are given an unsorted permutation p1,p2,…,pn. To sort the permutation, you choose a constant k (k≥1) and do some operations on the permutation. In one operation, you can choose two integers i, j (1≤j<i≤n) such that i−j=k, then swap pi and pj. What is the maximum value of k that you can choose to sort the given permutation? A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). An unsorted permutation p is a permutation such that there is at least one position i that satisfies pi≠i.",https://codeforces.com/problemset/problem/1828/B
62,"
Divisible Array                    ",800,"You are given a positive integer n. Please find an array a1,a2,…,an that is perfect. A perfect array a1,a2,…,an satisfies the following criteria:",https://codeforces.com/problemset/problem/1828/A
63,"
Copium Permutation                    ",3500,"You are given a permutation a1,a2,…,an of the first n positive integers. A subarray [l,r] is called copium if we can rearrange it so that it becomes a sequence of consecutive integers, or more formally, if max(al,al+1,…,ar)−min(al,al+1,…,ar)=r−l For each k in the range [0,n], print out the maximum number of copium subarrays of a over all ways of rearranging the last n−k elements of a.",https://codeforces.com/problemset/problem/1827/F
64,"
Bus Routes                    ",3400,"There is a country consisting of n cities and n−1 bidirectional roads connecting them such that we can travel between any two cities using these roads. In other words, these cities and roads form a tree. There are m bus routes connecting the cities together. A bus route between city x and city y allows you to travel between any two cities in the simple path between x and y with this route. Determine if for every pair of cities u and v, you can travel from u to v using at most two bus routes.",https://codeforces.com/problemset/problem/1827/E
65,"
Two Centroids                    ",2800,"You are given a tree (an undirected connected acyclic graph) which initially only contains vertex 1. There will be several queries to the given tree. In the i-th query, vertex i+1 will appear and be connected to vertex pi (1≤pi≤i).  After each query, please find out the least number of operations required to make the current tree has two centroids. In one operation, you can add one vertex and one edge to the tree such that it remains a tree. A vertex is called a centroid if its removal splits the tree into subtrees with at most ⌊n2⌋ vertices each, with n as the number of vertices of the tree. For example, the centroid of the following tree is 3 because the biggest subtree after removing the centroid has 2 vertices. In the next tree, vertex 1 and 2 are both centroids.",https://codeforces.com/problemset/problem/1827/D
66,"
Palindrome Partition                    ",2600,"A substring is a continuous and non-empty segment of letters from a given string, without any reorders. An even palindrome is a string that reads the same backward as forward and has an even length. For example, strings ""zz"", ""abba"", ""abccba"" are even palindromes, but strings ""codeforces"", ""reality"", ""aba"", ""c"" are not. A beautiful string is an even palindrome or a string that can be partitioned into some smaller even palindromes. You are given a string s, consisting of n lowercase Latin letters. Count the number of beautiful substrings of s.",https://codeforces.com/problemset/problem/1827/C
67,"
Range Sorting (Hard Version)                    ",2400,"The only difference between this problem and the easy version is the constraints on t and n. You are given an array a, consisting of n distinct integers a1,a2,…,an.  Define the beauty of an array p1,p2,…pk as the minimum amount of time needed to sort this array using an arbitrary number of range-sort operations. In each range-sort operation, you will do the following:  Please calculate the sum of beauty over all subarrays of array a. A subarray of an array is defined as a sequence of consecutive elements of the array.",https://codeforces.com/problemset/problem/1827/B2
68,"
Range Sorting (Easy Version)                    ",2000,"The only difference between this problem and the hard version is the constraints on t and n. You are given an array a, consisting of n distinct integers a1,a2,…,an.  Define the beauty of an array p1,p2,…pk as the minimum amount of time needed to sort this array using an arbitrary number of range-sort operations. In each range-sort operation, you will do the following:  Please calculate the sum of beauty over all subarrays of array a. A subarray of an array is defined as a sequence of consecutive elements of the array.",https://codeforces.com/problemset/problem/1827/B1
69,"
Counting Orders                    ",1100,"You are given two arrays a and b each consisting of n integers. All elements of a are pairwise distinct. Find the number of ways to reorder a such that ai>bi for all 1≤i≤n, modulo 109+7. Two ways of reordering are considered different if the resulting arrays are different.",https://codeforces.com/problemset/problem/1827/A
70,"
Fading into Fog                    ",2800,"This is an interactive problem. There are n distinct hidden points with real coordinates on a two-dimensional Euclidean plane. In one query, you can ask some line ax+by+c=0 and get the projections of all n points to this line in some order. The given projections are not exact, please read the interaction section for more clarity. Using the minimum number of queries, guess all n points and output them in some order. Here minimality means the minimum number of queries required to solve any possible test case with n points. The hidden points are fixed in advance and do not change throughout the interaction. In other words, the interactor is not adaptive. A projection of point A to line ax+by+c=0 is the point on the line closest to A.",https://codeforces.com/problemset/problem/1826/F
71,"
Walk the Runway                    ",2400,"A fashion tour consists of m identical runway shows in different cities. There are n models willing to participate in the tour, numbered from 1 to n. People in different cities have different views on the fashion industry, so they rate each model differently. In particular, people in city i rate model j with rating ri,j. You are to choose some number of k models, and their order, let the chosen models have indices j1,j2,…,jk in the chosen order. In each city, these k models will walk the runway one after another in this order. To make the show exciting, in each city, the ratings of models should be strictly increasing in the order of their performance. More formally, for any city i and index t (2≤t≤k), the ratings must satisfy ri,jt−1<ri,jt.  After all, the fashion industry is all about money, so choosing model j to participate in the tour profits you pj money. Compute the maximum total profit you can make by choosing the models and their order while satisfying all the requirements.",https://codeforces.com/problemset/problem/1826/E
72,"
Running Miles                    ",1700,"There is a street with n sights, with sight number i being i miles from the beginning of the street. Sight number i has beauty bi. You want to start your morning jog l miles and end it r miles from the beginning of the street. By the time you run, you will see sights you run by (including sights at l and r miles from the start). You are interested in the 3 most beautiful sights along your jog, but every mile you run, you get more and more tired. So choose l and r, such that there are at least 3 sights you run by, and the sum of beauties of the 3 most beautiful sights minus the distance in miles you have to run is maximized. More formally, choose l and r, such that bi1+bi2+bi3−(r−l) is maximum possible, where i1,i2,i3 are the indices of the three maximum elements in range [l,r].",https://codeforces.com/problemset/problem/1826/D
73,"
Dreaming of Freedom                    ",1300,"There are n programmers choosing their favorite algorithm amongst m different choice options. Before the first round, all m options are available. In each round, every programmer makes a vote for one of the remaining algorithms. After the round, only the algorithms with the maximum number of votes remain. The voting process ends when there is only one option left. Determine whether the voting process can continue indefinitely or no matter how people vote, they will eventually choose a single option after some finite amount of rounds?",https://codeforces.com/problemset/problem/1826/C
74,"
Lunatic Never Content                    ",1100,"You have an array a of n non-negative integers. Let's define f(a,x)=[a1modx,a2modx,…,anmodx] for some positive integer x. Find the biggest x, such that f(a,x) is a palindrome. Here, amodx is the remainder of the integer division of a by x. An array is a palindrome if it reads the same backward as forward. More formally, an array a of length n is a palindrome if for every i (1≤i≤n) ai=an−i+1.",https://codeforces.com/problemset/problem/1826/B
75,"
Trust Nobody                    ",1200,"There is a group of n people. Some of them might be liars, who always tell lies. Other people always tell the truth. The i-th person says ""There are at least li liars amongst us"". Determine if what people are saying is contradictory, or if it is possible. If it is possible, output the number of liars in the group. If there are multiple possible answers, output any one of them.",https://codeforces.com/problemset/problem/1826/A
76,"
LuoTianyi and the Table                    ",1000,"LuoTianyi gave an array b of n⋅m integers. She asks you to construct a table a of size n×m, filled with these n⋅m numbers, and each element of the array must be used exactly once. Also she asked you to maximize the following value: This means that we consider n⋅m subtables with the upper left corner in (1,1) and the bottom right corner in (i,j) (1≤i≤n, 1≤j≤m), for each such subtable calculate the difference of the maximum and minimum elements in it, then sum up all these differences. You should maximize the resulting sum. Help her find the maximal possible value, you don't need to reconstruct the table itself.",https://codeforces.com/problemset/problem/1825/B
77,"
LuoTianyi and the Palindrome String                    ",800,"LuoTianyi gives you a palindrome† string s, and she wants you to find out the length of the longest non-empty subsequence‡ of s which is not a palindrome string. If there is no such subsequence, output −1 instead. † A palindrome is a string that reads the same backward as forward. For example, strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not. ‡ A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from b. For example, strings ""a"", ""aaa"", ""bab"" are subsequences of string ""abaab"", but strings ""codeforces"", ""bbb"", ""h"" are not.",https://codeforces.com/problemset/problem/1825/A
78,"
LuoTianyi and Cartridge                    ",3500,"LuoTianyi is watching the anime Made in Abyss. She finds that making a Cartridge is interesting. To describe the process of making a Cartridge more clearly, she abstracts the original problem and gives you the following problem. You are given a tree T consisting of n vertices. Each vertex has values ai and bi and each edge has values cj and dj. Now you are aim to build a tree T′ as follows: Let A be the minimum of values ai in T′ and C be the minimum of values ci in T′. Let B be the sum of bi in T′ and D be the sum of values di in T′. Let min(A,C)⋅(B+D) be the cost of T′. You need to find the maximum possible cost of T′.",https://codeforces.com/problemset/problem/1824/E
79,"
LuoTianyi and the Function                    ",3000,"LuoTianyi gives you an array a of n integers and the index begins from 1. Define g(i,j) as follows: There are q queries. For each query you are given four integers l,r,x,y, you need to calculate r∑i=ly∑j=xg(i,j).",https://codeforces.com/problemset/problem/1824/D
80,"
LuoTianyi and XOR-Tree                    ",2500,"LuoTianyi gives you a tree with values in its vertices, and the root of the tree is vertex 1. In one operation, you can change the value in one vertex to any non-negative integer. Now you need to find the minimum number of operations you need to perform to make each path from the root to leaf† has a bitwise XOR value of zero. †A leaf in a rooted tree is a vertex that has exactly one neighbor and is not a root.",https://codeforces.com/problemset/problem/1824/C
81,"
LuoTianyi and the Floating Islands (Hard Version)                    ",2300,"This is the hard version of the problem. The only difference is that in this version k≤n. You can make hacks only if both versions of the problem are solved.  LuoTianyi now lives in a world with n floating islands. The floating islands are connected by n−1 undirected air routes, and any two of them can reach each other by passing the routes. That means, the n floating islands form a tree. One day, LuoTianyi wants to meet her friends: Chtholly, Nephren, William, .... Totally, she wants to meet k people. She doesn't know the exact positions of them, but she knows that they are in pairwise distinct islands. She define an island is good if and only if the sum of the distances† from it to the islands with k people is the minimal among all the n islands. Now, LuoTianyi wants to know that, if the k people are randomly set in k distinct of the n islands, then what is the expect number of the good islands? You just need to tell her the expect number modulo 109+7. †The distance between two islands is the minimum number of air routes you need to take to get from one island to the other.",https://codeforces.com/problemset/problem/1824/B2
82,"
LuoTianyi and the Floating Islands (Easy Version)                    ",1800,"This is the easy version of the problem. The only difference is that in this version k≤min(n,3). You can make hacks only if both versions of the problem are solved. LuoTianyi now lives in a world with n floating islands. The floating islands are connected by n−1 undirected air routes, and any two of them can reach each other by passing the routes. That means, the n floating islands form a tree. One day, LuoTianyi wants to meet her friends: Chtholly, Nephren, William, .... Totally, she wants to meet k people. She doesn't know the exact positions of them, but she knows that they are in pairwise distinct islands. She define an island is good if and only if the sum of the distances† from it to the islands with k people is the minimal among all the n islands. Now, LuoTianyi wants to know that, if the k people are randomly set in k distinct of the n islands, then what is the expect number of the good islands? You just need to tell her the expect number modulo 109+7. †The distance between two islands is the minimum number of air routes you need to take to get from one island to the other.",https://codeforces.com/problemset/problem/1824/B1
83,"
LuoTianyi and the Show                    ",1400,"There are n people taking part in a show about VOCALOID. They will sit in the row of seats, numbered 1 to m from left to right. The n people come and sit in order. Each person occupies a seat in one of three ways:  Now you want to know what is the maximum number of people that can take a seat, if you can let people into the show in any order?",https://codeforces.com/problemset/problem/1824/A
84,"
Random Walk                    ",2600,"You are given a tree consisting of n vertices and n−1 edges, and each vertex v has a counter c(v) assigned to it. Initially, there is a chip placed at vertex s and all counters, except c(s), are set to 0; c(s) is set to 1. Your goal is to place the chip at vertex t. You can achieve it by a series of moves. Suppose right now the chip is placed at the vertex v. In one move, you do the following: You'll repeat the move above until you reach the vertex t. For each vertex v calculate the expected value of c(v) modulo 998244353.",https://codeforces.com/problemset/problem/1823/F
85,"
Removing Graph                    ",2500,"Alice and Bob are playing a game on a graph. They have an undirected graph without self-loops and multiple edges. All vertices of the graph have degree equal to 2. The graph may consist of several components. Note that if such graph has n vertices, it will have exactly n edges. Alice and Bob take turn. Alice goes first. In each turn, the player can choose k (l≤k≤r; l<r) vertices that form a connected subgraph and erase these vertices from the graph, including all incident edges. The player who can't make a step loses. For example, suppose they are playing on the given graph with given l=2 and r=3: A valid vertex set for Alice to choose at the first move is one of the following:  Then a valid vertex set for Bob to choose at the first move is one of the following:  Alice can't make a move, so she loses. You are given a graph of size n and integers l and r. Who will win if both Alice and Bob play optimally.",https://codeforces.com/problemset/problem/1823/E
86,"
Unique Palindromes                    ",1900,"A palindrome is a string that reads the same backwards as forwards. For example, the string abcba is palindrome, while the string abca is not. Let p(t) be the number of unique palindromic substrings of string t, i. e. the number of substrings t[l…r] that are palindromes themselves. Even if some substring occurs in t several times, it's counted exactly once. (The whole string t is also counted as a substring of t). For example, string t = abcbbcabcb has p(t)=6 unique palindromic substrings: a, b, c, bb, bcb and cbbc. Now, let's define p(s,m)=p(t) where t=s[1…m]. In other words, p(s,m) is the number of palindromic substrings in the prefix of s of length m. For example, p(abcbbcabcb,5) = p(abcbb)=5. You are given an integer n and k ""conditions"" (k≤20). Let's say that string s, consisting of n lowercase Latin letters, is good if all k conditions are satisfied at the same time. A condition is a pair (xi,ci) and have the following meaning:  Look in Notes if you need further clarifications.",https://codeforces.com/problemset/problem/1823/D
87,"
Strongly Composite                    ",1300,"A prime number is an integer greater than 1, which has exactly two divisors. For example, 7 is a prime, since it has two divisors {1,7}. A composite number is an integer greater than 1, which has more than two different divisors. Note that the integer 1 is neither prime nor composite. Let's look at some composite number v. It has several divisors: some divisors are prime, others are composite themselves. If the number of prime divisors of v is less or equal to the number of composite divisors, let's name v as strongly composite. For example, number 12 has 6 divisors: {1,2,3,4,6,12}, two divisors 2 and 3 are prime, while three divisors 4, 6 and 12 are composite. So, 12 is strongly composite. Other examples of strongly composite numbers are 4, 8, 9, 16 and so on. On the other side, divisors of 15 are {1,3,5,15}: 3 and 5 are prime, 15 is composite. So, 15 is not a strongly composite. Other examples are: 2, 3, 5, 6, 7, 10 and so on. You are given n integers a1,a2,…,an (ai>1). You have to build an array b1,b2,…,bk such that following conditions are satisfied:  Find the size k of array b, or report, that there is no array b satisfying the conditions.",https://codeforces.com/problemset/problem/1823/C
88,"
Sort with Step                    ",900,"Let's define a permutation of length n as an array p of length n, which contains every number from 1 to n exactly once. You are given a permutation p1,p2,…,pn and a number k. You need to sort this permutation in the ascending order. In order to do it, you can repeat the following operation any number of times (possibly, zero):  Unfortunately, some permutations can't be sorted with some fixed numbers k. For example, it's impossible to sort [2,4,3,1] with k=2. That's why, before starting the sorting, you can make at most one preliminary exchange:  Your task is to:  For example, if k=2 and permutation is [2,4,3,1], then you can make a preliminary exchange of p1 and p4, which will produce permutation [1,4,3,2], which is possible to sort with given k.",https://codeforces.com/problemset/problem/1823/B
89,"
A-characteristic                    ",800,"Consider an array a1,a2,…,an consisting of numbers 1 and −1. Define A-characteristic of this array as a number of pairs of indices 1≤i<j≤n, such that ai⋅aj=1. Find any array a with given length n with A-characteristic equal to the given value k.",https://codeforces.com/problemset/problem/1823/A
90,"
Magic Triples (Hard Version)                    ",2200,"This is the hard version of the problem. The only difference is that in this version, ai≤109. For a given sequence of n integers a, a triple (i,j,k) is called magic if:  Kolya received a sequence of integers a as a gift and now wants to count the number of magic triples for it. Help him with this task! Note that there are no constraints on the order of integers i, j and k.",https://codeforces.com/problemset/problem/1822/G2
91,"
Magic Triples (Easy Version)                    ",1700,"This is the easy version of the problem. The only difference is that in this version, ai≤106. For a given sequence of n integers a, a triple (i,j,k) is called magic if:  Kolya received a sequence of integers a as a gift and now wants to count the number of magic triples for it. Help him with this task! Note that there are no constraints on the order of integers i, j and k.",https://codeforces.com/problemset/problem/1822/G1
92,"
Gardening Friends                    ",1700,"Two friends, Alisa and Yuki, planted a tree with n vertices in their garden. A tree is an undirected graph without cycles, loops, or multiple edges. Each edge in this tree has a length of k. Initially, vertex 1 is the root of the tree. Alisa and Yuki are growing the tree not just for fun, they want to sell it. The cost of the tree is defined as the maximum distance from the root to a vertex among all vertices of the tree. The distance between two vertices u and v is the sum of the lengths of the edges on the path from u to v. The girls took a course in gardening, so they know how to modify the tree. Alisa and Yuki can spend c coins to shift the root of the tree to one of the neighbors of the current root. This operation can be performed any number of times (possibly zero). Note that the structure of the tree is left unchanged; the only change is which vertex is the root. The friends want to sell the tree with the maximum profit. The profit is defined as the difference between the cost of the tree and the total cost of operations. The profit is cost of the tree minus the total cost of operations. Help the girls and find the maximum profit they can get by applying operations to the tree any number of times (possibly zero).",https://codeforces.com/problemset/problem/1822/F
93,"
Making Anti-Palindromes                    ",1600,"You are given a string s, consisting of lowercase English letters. In one operation, you are allowed to swap any two characters of the string s. A string s of length n is called an anti-palindrome, if s[i]≠s[n−i+1] for every i (1≤i≤n). For example, the strings ""codeforces"", ""string"" are anti-palindromes, but the strings ""abacaba"", ""abc"", ""test"" are not. Determine the minimum number of operations required to make the string s an anti-palindrome, or output −1, if this is not possible.",https://codeforces.com/problemset/problem/1822/E
94,"
Super-Permutation                    ",1200,"A permutation is a sequence n integers, where each integer from 1 to n appears exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not. Given a permutation a, we construct an array b, where bi=(a1+a2+ … +ai)modn. A permutation of numbers [a1,a2,…,an] is called a super-permutation if [b1+1,b2+1,…,bn+1] is also a permutation of length n. Grisha became interested whether a super-permutation of length n exists. Help him solve this non-trivial problem. Output any super-permutation of length n, if it exists. Otherwise, output −1.",https://codeforces.com/problemset/problem/1822/D
95,"
Bun Lover                    ",800,"Tema loves cinnabon rolls — buns with cinnabon and chocolate in the shape of a ""snail"". Cinnabon rolls come in different sizes and are square when viewed from above. The most delicious part of a roll is the chocolate, which is poured in a thin layer over the cinnabon roll in the form of a spiral and around the bun, as in the following picture:  Cinnabon rolls of sizes 4, 5, 6  For a cinnabon roll of size n, the length of the outer side of the square is n, and the length of the shortest vertical chocolate segment in the central part is one. Formally, the bun consists of two dough spirals separated by chocolate. A cinnabon roll of size n+1 is obtained from a cinnabon roll of size n by wrapping each of the dough spirals around the cinnabon roll for another layer. It is important that a cinnabon roll of size n is defined in a unique way. Tema is interested in how much chocolate is in his cinnabon roll of size n. Since Tema has long stopped buying small cinnabon rolls, it is guaranteed that n≥4. Answer this non-obvious question by calculating the total length of the chocolate layer.",https://codeforces.com/problemset/problem/1822/C
96,"
Karina and Array                    ",800,"Karina has an array of n integers a1,a2,a3,…,an. She loves multiplying numbers, so she decided that the beauty of a pair of numbers is their product. And the beauty of an array is the maximum beauty of a pair of adjacent elements in the array. For example, for n=4, a=[3,5,7,4], the beauty of the array is max(3⋅5, 5⋅7, 7⋅4) = max(15, 35, 28) = 35. Karina wants her array to be as beautiful as possible. In order to achieve her goal, she can remove some elements (possibly zero) from the array. After Karina removes all elements she wants to, the array must contain at least two elements. Unfortunately, Karina doesn't have enough time to do all her tasks, so she asks you to calculate the maximum beauty of the array that she can get by removing any number of elements (possibly zero).",https://codeforces.com/problemset/problem/1822/B
97,"
TubeTube Feed                    ",800,"Mushroom Filippov cooked himself a meal and while having his lunch, he decided to watch a video on TubeTube. He can not spend more than t seconds for lunch, so he asks you for help with the selection of video. The TubeTube feed is a list of n videos, indexed from 1 to n. The i-th video lasts ai seconds and has an entertainment value bi. Initially, the feed is opened on the first video, and Mushroom can skip to the next video in 1 second (if the next video exists). Mushroom can skip videos any number of times (including zero). Help Mushroom choose one video that he can open and watch in t seconds. If there are several of them, he wants to choose the most entertaining one. Print the index of any appropriate video, or −1 if there is no such.",https://codeforces.com/problemset/problem/1822/A
98,"
Timber                    ",2600,"There is a beautiful alley with trees in front of a shopping mall. Unfortunately, it has to go to make space for the parking lot. The trees on the alley all grow in a single line. There are n spots for trees, index 0 is the shopping mall, index n+1 is the road and indices from 1 to n are the spots for trees. Some of them are taken — there grow trees of the same height k. No more than one tree grows in each spot. When you chop down a tree in the spot x, you can make it fall either left or right. If it falls to the left, it takes up spots from x−k to x, inclusive. If it falls to the right, it takes up spots from x to x+k, inclusive. Let m trees on the alley grow in some spots x1,x2,…,xm. Let an alley be called unfortunate if all m trees can be chopped down in such a way that:  Calculate the number of different unfortunate alleys with m trees of height k. Two alleys are considered different if there is a spot y such that a tree grows in y on the first alley and doesn't grow in y on the second alley. Output the number modulo 998244353.",https://codeforces.com/problemset/problem/1821/F
99,"
Rearrange Brackets                    ",2100,"A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example: You are given a regular bracket sequence. In one move, you can remove a pair of adjacent brackets such that the left one is an opening bracket and the right one is a closing bracket. Then concatenate the resulting parts without changing the order. The cost of this move is the number of brackets to the right of the right bracket of this pair. The cost of the regular bracket sequence is the smallest total cost of the moves required to make the sequence empty. Actually, you are not removing any brackets. Instead, you are given a regular bracket sequence and an integer k. You can perform the following operation at most k times:  After all operations are performed, the bracket sequence has to be regular. What is the smallest possible cost of the resulting regular bracket sequence?",https://codeforces.com/problemset/problem/1821/E
